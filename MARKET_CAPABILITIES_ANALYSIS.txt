================================================================================
ğŸ“Š ANÃLISIS DETALLADO: CAPACIDADES DEL MODELO phase2_voting_market.pkl
================================================================================
Fecha: 2025-12-28
Modelo: Voting Ensemble (RF + GB) con 32 market features

================================================================================
âŒ RESPUESTA DIRECTA: Â¿QUÃ‰ MERCADOS PREDICE?
================================================================================

SOLO PREDICE: 1X2 (Resultado Final del Partido)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ phase2_voting_market.pkl                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Mercado: 1X2 - RESULTADO FINAL                                            â”‚
â”‚  â”œâ”€ Outcome 1: Local Gana (H)                                              â”‚
â”‚  â”œâ”€ Outcome X: Empate (D)                                                  â”‚
â”‚  â””â”€ Outcome 2: Visitante Gana (A)                                          â”‚
â”‚                                                                             â”‚
â”‚  Target variable usado: df['FullTimeResult'].map({'A': 0, 'D': 1, 'H': 2})â”‚
â”‚  Cobertura: 9,510 partidos histÃ³ricos                                      â”‚
â”‚  Accuracy: 80.38% en test set                                              â”‚
â”‚  Features: 59 totales (28 tradicionales + 31 de mercado)                   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
âš ï¸  MERCADOS QUE NO PREDICE (Y POR QUÃ‰)
================================================================================

â”Œâ”€ OVER/UNDER 2.5 GOLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  âŒ NO predicho por phase2_voting_market.pkl                               â”‚
â”‚                                                                             â”‚
â”‚  RazÃ³n tÃ©cnica:                                                             â”‚
â”‚  â€¢ Target variable usado: FullTimeResult (3 clases: H/D/A)                 â”‚
â”‚  â€¢ Target requerido para O/U 2.5: Total goles > 2.5? (2 clases: Si/No)     â”‚
â”‚  â€¢ El modelo estÃ¡ optimizado para predecir RESULTADO, no GOLES             â”‚
â”‚                                                                             â”‚
â”‚  AnalogÃ­a:                                                                  â”‚
â”‚  El modelo estÃ¡ entrenado para predecir "Â¿QuiÃ©n gana?"                      â”‚
â”‚  Pero no estÃ¡ entrenado para predecir "Â¿CuÃ¡ntos goles se marcan?"           â”‚
â”‚                                                                             â”‚
â”‚  InformaciÃ³n en el cÃ³digo:                                                  â”‚
â”‚    y_result = df_proc['FullTimeResult'].map(result_map)  âœ… USADO          â”‚
â”‚    y_goals = df_proc['FullTimeHomeGoals'] + ...          âŒ NO USADO       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ BTTS (BOTH TEAMS TO SCORE) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  âŒ NO predicho por phase2_voting_market.pkl                               â”‚
â”‚                                                                             â”‚
â”‚  RazÃ³n tÃ©cnica:                                                             â”‚
â”‚  â€¢ Target variable usado: FullTimeResult (3 clases: H/D/A)                 â”‚
â”‚  â€¢ Target requerido para BTTS: home_goals>0 AND away_goals>0? (Si/No)      â”‚
â”‚  â€¢ El modelo estÃ¡ entrenado para predecir QUIÃ‰N GANA, no SI ANOTAN AMBOS   â”‚
â”‚                                                                             â”‚
â”‚  Ejemplo de diferencia:                                                     â”‚
â”‚  Partido: Manchester United 2 - 1 Arsenal                                   â”‚
â”‚  â”œâ”€ 1X2: Predice correctamente = Local Gana (H)                            â”‚
â”‚  â”œâ”€ BTTS: DeberÃ­a predecir = SÃ (2>0 AND 1>0)                              â”‚
â”‚  â””â”€ Problema: El modelo NO fue entrenado para BTTS                         â”‚
â”‚                                                                             â”‚
â”‚  InformaciÃ³n en el cÃ³digo:                                                  â”‚
â”‚    'IsUnderdog_Home' âœ… Feature disponible                                  â”‚
â”‚    'IsUpset' âœ… Feature disponible                                          â”‚
â”‚    Pero NO hay target especÃ­fico para BTTS                                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
ğŸ“Š COMPARACIÃ“N VISUAL: LOS 3 MERCADOS vs CAPACIDADES DEL MODELO
================================================================================

MERCADO           â”‚ PREDICE â”‚ RAZÃ“N
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1X2 (Resultado)   â”‚  âœ… SÃ  â”‚ Target: FullTimeResult (H/D/A) â†’ USADO en train
Over/Under 2.5    â”‚  âŒ NO  â”‚ Target: total_goles > 2.5 â†’ NO EXISTE en train
BTTS              â”‚  âŒ NO  â”‚ Target: home>0 AND away>0 â†’ NO EXISTE en train
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
ğŸ” CÃ“DIGO: EVIDENCIA DE LO QUE SE ENTRENA
================================================================================

LÃ­nea 455-457 del retrain_with_market_features.py:

    # Targets
    result_map = {'A': 0, 'D': 1, 'H': 2}
    y_result = df_proc['FullTimeResult'].map(result_map)     âœ… USADO
    y_goals = df_proc['FullTimeHomeGoals'] + df_proc['FullTimeAwayGoals']  âŒ CARGADO PERO NO USADO

LÃ­nea 451-453:
    results, models, scaler_bl, scaler_mk = train_and_compare(
        X_baseline, X_market, y_result, y_goals    â† y_result se usa, y_goals NO
    )

LÃ­nea 173 de train_and_compare():
    y_train, y_test = y_result[:split_idx], y_result[split_idx:]  â† SOLO y_result

================================================================================
ğŸ’¡ Â¿POR QUÃ‰ run_analysis.py INTENTA PREDECIR 3 MERCADOS SI EL MODELO SOLO PREDICE 1?
================================================================================

En run_analysis.py (lÃ­neas 90-230):

1. Carga goles_totales y btts (lÃ­neas 90, 113)
2. Intenta PARSEAR output esperando predicciones de Over/Under y BTTS
3. Pero predict_match.py / src/predictor.py TAMBIÃ‰N solo predice 1X2

Flujo real:
   run_analysis.py â† solicita Over/Under y BTTS
   â””â”€ predict_match.py â† solo devuelve 1X2
      â””â”€ src/predictor.py â† solo carga modelos 1X2
         â””â”€ Busca en models/ â† EXISTEN archivos antiguos (rf_goals_model.pkl, etc.)
            pero phase2_voting_market.pkl SOLO predice 1X2

================================================================================
ğŸ¯ Â¿QUÃ‰ HACER SI QUIERES PREDECIR LOS 3 MERCADOS?
================================================================================

OpciÃ³n 1: ENTRENAR MODELOS ESPECÃFICOS POR MERCADO (Recomendado)

1. Crear 3 modelos separados:

   Modelo 1X2: y_result = FullTimeResult (H/D/A)
   â”œâ”€ Random Forest â†’ phase2_rf_1x2_market.pkl
   â”œâ”€ Gradient Boosting â†’ phase2_gb_1x2_market.pkl
   â””â”€ Voting â†’ phase2_voting_1x2_market.pkl âœ… ACTUAL

   Modelo Over/Under 2.5: y_over_under = (total_goals > 2.5).astype(int)
   â”œâ”€ Random Forest â†’ phase2_rf_ou25_market.pkl
   â”œâ”€ Gradient Boosting â†’ phase2_gb_ou25_market.pkl
   â””â”€ Voting â†’ phase2_voting_ou25_market.pkl

   Modelo BTTS: y_btts = (home_goals > 0) & (away_goals > 0).astype(int)
   â”œâ”€ Random Forest â†’ phase2_rf_btts_market.pkl
   â”œâ”€ Gradient Boosting â†’ phase2_gb_btts_market.pkl
   â””â”€ Voting â†’ phase2_voting_btts_market.pkl

2. Modificar retrain_with_market_features.py para entrenar 3 objetivos:
   - Cambiar target variable en cada iteraciÃ³n
   - Ejecutar train_and_compare() 3 veces con targets diferentes

3. Actualizar predict_match.py para cargar 3 modelos y hacer 3 predicciones

Ventajas:
   âœ“ Cada modelo optimizado especÃ­ficamente para su mercado
   âœ“ Mejor accuracy para cada predicciÃ³n
   âœ“ Interpretabilidad clara

OpciÃ³n 2: USAR FEATURES DERIVADAS (Post-procesamiento)

   predict_match.py devuelve predicciÃ³n 1X2 â†’ fÃ¡cil extraer:
   
   â€¢ Over/Under: Si predicciÃ³n = LOCAL, entonces goles probablemente altos
   â€¢ BTTS: Si predicciÃ³n = EMPATE, entonces ambos equipos anotan probablemente

Desventajas:
   âœ— No es tan preciso como entrenar modelos especÃ­ficos
   âœ— Basado en correlaciones, no en datos reales

================================================================================
ğŸ“‹ RESUMEN EJECUTIVO
================================================================================

PREGUNTA: Â¿Predice phase2_voting_market.pkl los 3 mercados (1X2, O/U 2.5, BTTS)?

RESPUESTA PRECISA:
   âœ… SÃ predice: 1X2 (Resultado Final)
   âŒ NO predice: Over/Under 2.5 goles
   âŒ NO predice: BTTS (Both Teams To Score)

RAZÃ“N TÃ‰CNICA:
   El modelo fue entrenado SOLO con FullTimeResult como target variable.
   No fue entrenado con targets para Over/Under o BTTS.

RECOMENDACIÃ“N:
   Si necesitas predecir los 3 mercados con precisiÃ³n similar (80%+),
   debes entrenar 3 modelos por separado, cada uno optimizado para su mercado.

================================================================================
